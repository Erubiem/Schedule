# ParserAsset

---

<aside>
ğŸ’¡ **HEADER**

</aside>

---

# ê°œìš”

---

ì—ì…‹ íŒŒì¼ ì•ˆì˜ ë°ì´í„°ë¥¼ ë¹¼ëŠ” ë°©ë²•ê³¼ ë°ì´í„°ë¥¼ ìˆœì„œëŒ€ë¡œ ì—‘ì…€ì— ë„£ëŠ” ê²ƒì— ëŒ€í•œ ë¬¸ì„œ

<aside>
âš ï¸ ì‘ì„±ì‹œê¸° 2023ë…„ 03ì›”

</aside>

<aside>
âš ï¸ Visual Studio 2022, Excel 2013ì—ì„œ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.

</aside>

---

* ì‚¬ìš© ëª©ì 
  1. ASSET í™•ì¥ì íŒŒì¼ì—ì„œ í•„ìš”í•œ ê°’ë“¤ì„ ë½‘ì•„ì„œ ì—‘ì…€ì— ë„£ì–´ì„œ ì •ë ¬ì‹œí‚¤ëŠ” ê²ƒ.

* êµ¬ì„± ìš”ì†Œ
    1.  ë°ì´í„°ë¥¼ ë½‘ì„ ì—ì…‹ íŒŒì¼ì´ ë‹´ê¸´ í´ë”
    2.	ë°ì´í„°ë¥¼ ì—‘ì…€ë¡œ ë½‘ì•„ë‚´ì„œ ì €ì¥í•  í´ë” 


## 1) ì¤€ë¹„ ì‘ì—…

1. ë¨¼ì € í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ê¸° ì „ì— Visual Studio Installerì— ë“¤ì–´ê°‘ë‹ˆë‹¤.
2. ì›Œí¬ë¡œë“œ ì¹¸ì— '.NET ë°ìŠ¤í¬ì½¥ ê°œë°œ'ì´ë¼ê³  ì¨ì ¸ ìˆëŠ” ì¹¸ì„ í´ë¦­í•˜ê³  ì„¤ì¹˜í•´ì£¼ë©´, ì¤€ë¹„ê°€ ëë‚©ë‹ˆë‹¤.
---------------------------------------------------------------------------------------------------------------------------------------------

## 2) ì½”ë“œ ì‚¬ìš© ë°©ë²•

1. ë¨¼ì € Visual Studioì—ì„œ 'ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ê¸°'ë¥¼ í´ë¦­í•´ì¤ë‹ˆë‹¤. 
2. ì„¤ì¹˜ë¥¼ í•´ì¤„ í”„ë¡œì íŠ¸ëŠ” 'ì½˜ì†” ì•±(.NET Framework)'(C#) ì´ë‹ˆ ê²€ìƒ‰ì„ í•˜ê±°ë‚˜ ìŠ¤í¬ë¡¤ì„ ë‚´ë ¤ì„œ ì°¾ìŠµë‹ˆë‹¤.
3. ì´í›„ì— ìƒˆ ì°½ì´ ë‚˜ì˜¤ëŠ”ë° ì´ ê¸€ ë°‘ì— ìˆëŠ” ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.
4. ì´ ì½”ë“œë¥¼ í•˜ê¸° ì „ Visual Studio 2022ì—ì„œëŠ” í”„ë¡œì íŠ¸->ì°¸ì¡° ì¶”ê°€->COM->ê²€ìƒ‰ì—ì„œ 'Excel' íƒ€ì´í•‘ í•´ì£¼ë©´ Microft Excel 15.0 Object Libraryê°€ ë‚˜ì˜¤ëŠ”ë° ì™¼ìª½ ìƒìë¥¼ í´ë¦­í•˜ì—¬ ì¶”ê°€í•˜ê³  í™•ì¸ì„ ëˆŒëŸ¬ì¤˜ì•¼ í•©ë‹ˆë‹¤.
5. ë§ˆì§€ë§‰ìœ¼ë¡œ ì—ì…‹íŒŒì¼ì´ ë“¤ì–´ìˆëŠ” í´ë”ì˜ ê²½ë¡œë¥¼ ì°¾ê³  ê²½ë¡œì˜ ê¸¸ì´ë¥¼ ì¬ì•¼í•©ë‹ˆë‹¤.
6. ê²½ë¡œë¥¼ ì°¾ì•˜ë‹¤ë©´ ì„¸ ê°œì˜ ë³€ìˆ˜ë¥¼ ë°”ê¿”ì¤˜ì•¼ í•©ë‹ˆë‹¤.
--------------------------------------------------------------------------------------------------------------------------------------------- 
 ### ì²« ë²ˆì§¸ 
 ```C#
string directoryPath = @"ì—‘ì…€ë¡œ ë°”ê¿€ í´ë”ì˜ ";
```
 - ì´ ë³€ìˆ˜ëŠ” ì—‘ì…€ë¡œ ë°”ê¿€ í´ë”ì˜ ê²½ë¡œë¥¼ ì •í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.
 - ê·¸ë ‡ê¸°ì— í´ë”ë¡œ ê°€ì„œ ê²½ë¡œë¥¼ ë³µì‚¬í•´ì£¼ê³  ìŒë”°ì˜´í‘œ ì•ˆì— ë¶™ì—¬ë„£ê¸°ë¥¼ í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

 ### ë‘ ë²ˆì§¸ 
```C#
 Directory.CreateDirectory(path[0] + "\\" + path[1] + "\\" + path[2] + "\\" + path[3] + "\\" +
  path[4] + "\\" + path[5]);
```
 - ì´ ë³€ìˆ˜ëŠ” ë””ë ‰í† ë¦¬ë¥¼ ë”°ë¡œ í•˜ë‚˜ ë³µì‚¬í•´ì„œ ì—‘ì…€ë¡œ ë°”ê¾¼ íŒŒì¼ë“¤ì„ ë„£ìŠµë‹ˆë‹¤. 
 - \ë§ˆë‹¤ ë‚˜ëˆ´ê¸° ë•Œë¬¸ì— ê¸¸ì´ì— ë”°ë¼ ìˆ˜ì •ì„ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.
 - ì˜ˆë¥¼ ë“¤ì–´ë³´ìë©´ C:\Users\SESI\Downloads\homework\testFinal ì— íŒŒì¼ì´ ë‹´ê²¨ ìˆëŠ” í´ë”ë“¤ì´ ìˆìœ¼ë©´ 
 - C:ì´ path[0]ì´ê³  Userê°€ path[1], SESTê°€ path[2]. ì´ëŸ° ì‹ìœ¼ë¡œ ê¸¸ì´ì— ë”°ë¼ ë„£ìœ¼ë©´ ë˜ë‹ˆ ì´ê±´ path[5]ê¹Œì§€ ë„£ìœ¼ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

 ### ì„¸ ë²ˆì§¸ 
```C#
 string savePath = path[0] + "\\" + path[1] + "\\" + path[2] + "\\" + path[3] + "\\" +
  path[4] + "\\" + path[5] + "\\" + fileName[0];
```
 - ì—‘ì…€ íŒŒì¼ì„ ì €ì¥í•˜ëŠ” ê²½ë¡œ ì„¤ì •í•˜ëŠ” ë³€ìˆ˜ì´ê¸°ì—.
 - ì•„ê¹Œ í´ë”ì˜ ê²½ë¡œë¥¼ ì„¤ì •í•´ì™”ìœ¼ë‹ˆ ê·¸ê±¸ ë³µì‚¬ ë¶™ì—¬ë„£ê¸°ë¥¼ í•˜ê³  ë§ˆì§€ë§‰ì— + path[5] + "\\" + fileName[0] ë¥¼ ë„£ìœ¼ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤. 
 - ì´ë ‡ê²Œ í•˜ë©´ ê° ì—ì…‹ íŒŒì¼ì´ ëª¨ë‘ ì—‘ì…€ íŒŒì¼ë¡œ ë°”ë€Œì–´ì§„ ê´‘ê²½ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---------------------------------------------------------------------------------------------------------------------------------------------
 ##  3) ë„¤ì„ìŠ¤í˜ì´ìŠ¤
```C#
using Excel = Microsoft.Office.Interop.Excel;
using Microsoft.Office.Interop.Excel;
```
ì´ ë‘ ê°œëŠ” C# ì½”ë“œ ë‚´ì—ì„œ Excel í†µí•© ë¬¸ì„œ, ì›Œí¬ì‹œíŠ¸, ì…€ ë° ê¸°íƒ€ ê´€ë ¨ ê°œì²´ì— ì•¡ì„¸ìŠ¤í•˜ê³  ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë¨¼ì € ì—‘ì…€ì„ ë§Œë“¤ê¸° ìœ„í•´ì„  ì´ ë‘ ê°œì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. 

- ì²« ë²ˆì§¸ ì¤„ì€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ ë³„ì¹­ "Excel"ì„ ë§Œë“­ë‹ˆë‹¤. 
ì´ë ‡ê²Œ í•˜ë©´ ì½”ë“œì˜ ë‹¤ë¥¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë˜ëŠ” í´ë˜ìŠ¤ì™€ì˜ ì´ë¦„ ì¶©ëŒì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë‘ ë²ˆì§¸ ì¤„ì€ C# ì½”ë“œì—ì„œ Excel ì‘ì—…ì„ ìë™í™”í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëª¨ë“  í´ë˜ìŠ¤, ì¸í„°í˜ì´ìŠ¤ ë° ì—´ê±°í˜•ì„ í¬í•¨í•˜ëŠ” ì „ì²´ Excel ê°œì²´ ëª¨ë¸ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
---------------------------------------------------------------------------------------------------------------------------------------------

#### ë‚˜ë¨¸ì§€ ë„¤ì„ ìŠ¤í˜ì´ìŠ¤
 - System.Text: í…ìŠ¤íŠ¸ë¥¼ ì¸ì½”ë”©, ë””ì½”ë”© ë° ì¡°ì‘í•˜ê¸° ìœ„í•œ í˜•ì‹ê³¼ í´ë˜ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
 - System.Threading.Tasks: TAP(ì‘ì—… ê¸°ë°˜ ë¹„ë™ê¸° íŒ¨í„´)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸° ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•œ í˜•ì‹ê³¼ í´ë˜ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
 - System.Runtime.InteropServices: C# ì½”ë“œì—ì„œ DLL í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒê³¼ ê°™ì´ ë¹„ê´€ë¦¬ ì½”ë“œì™€ ìƒí˜¸ ì‘ìš©í•˜ê¸° ìœ„í•œ í˜•ì‹ ë° í´ë˜ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
 - System.Data.Common: ê³µìš© ADO.NET ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ë°ì´í„° ê³µê¸‰ìì™€ í•¨ê»˜ ì‘ì—…í•˜ê¸° ìœ„í•œ í˜•ì‹ê³¼ í´ë˜ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
---------------------------------------------------------------------------------------------------------------------------------------------

 ##  4) ì¤‘ìš” ì½”ë“œ
 
 ### 4.1) 
```C#
string[] lines = File.ReadAllLines(excelFilePath);
 for (int i = 2; i <= count; i++) 
     {
     }
```
* ì´ ë‘ ì½”ë“œëŠ” íŒŒì¼ì„ ê°€ì ¸ì™”ì„ ë•Œ íŒŒì¼ì˜ í…ìŠ¤íŠ¸ë¥¼ ì‹¹ ë‹¤ ì½ì–´ì˜¤ê³ 
* ì—´ì´ 2ë²ˆì§¸ë¶€í„° ì¶œë ¥ë˜ê¸° ë•Œë¬¸ì— ië¥¼ 2ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.

 ### 4.2) 
```C#
Application excel = new Application();
Workbook workbook = excel.Workbooks.Add();
Worksheet worksheet = workbook.Sheets[1]; //storytimeline

workbook.SaveAs(savePath);
workbook.Close();
excel.Quit();

```
* Excelì„ ìë™í™”í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Excel ì‘ìš© í”„ë¡œê·¸ë¨ì˜ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ê°€ ë§Œë“¤ê³  í†µí•©ë¬¸ì„œì™€ ì›Œí¬ ì‹œíŠ¸ë¥¼ ë§Œë“­ë‹ˆë‹¤.
* í›„ì— ì‘ì—…ì´ ëë‚˜ë©´ ì—‘ì…€ì„ ì „ì²´ì ìœ¼ë¡œ ì´ ì½”ë“œëŠ” Excel í†µí•© ë¬¸ì„œë¥¼ ì§€ì •ëœ íŒŒì¼ ê²½ë¡œì— ì €ì¥í•œ ë‹¤ìŒ ì—°ê²°ëœ ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ ì ì ˆí•˜ê²Œ í•´ì œí•˜ì—¬ í†µí•© ë¬¸ì„œì™€ ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì™„ì „íˆ ë‹«íˆê³  ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë˜ëŠ” ê¸°íƒ€ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤.


 ### 4.3) 
```C#
if (line.Contains(variable))
    {
    }
```
* ì´ í•¨ìˆ˜ë¥¼ í†µí•´ í…ìŠ¤íŠ¸ì—ì„œ ì¤„ë§ˆë‹¤ string ë³€ìˆ˜ variableì´ ì •ì˜ëœ ê°’ì´ í¬í•¨ëœ ì¤„ì„ ì½ì–´ì˜µë‹ˆë‹¤.


 ### 4.4) 
```C#
ReleaseExcelObject()
```
* ì´ëŸ¬í•œ ì½”ë“œ ì¤„ì€ Excel ê°œì²´ì™€ ì—°ê²°ëœ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ì œëŒ€ë¡œ í•´ì œë˜ë„ë¡ í•˜ë„ë¡ í•˜ë©°, ì´ëŠ” ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë° ê¸°íƒ€ ë¬¸ì œë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.



## ì „ì²´ ì½”ë“œ

```C#
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;
using Microsoft.Office.Interop.Excel;
using System.Data;



namespace Excel_parseer
{
    internal class Program
    {
        static void Main(string[] args)
        {
            Console.OutputEncoding = Encoding.GetEncoding("Shift-JIS");

            string directoryPath = @"ì—‘ì…€ë¡œ ë°”ê¿€ í´ë”ì˜ ";

            // Get all file paths in the directory with the .asset extension
            //string[] excelFilePaths = Directory.GetFiles(directoryPath, "*.asset", SearchOption.AllDirectories);
            string[] excelFilePaths = Directory.GetFiles(directoryPath, "*.asset", SearchOption.AllDirectories)
             .Where(filePath => Path.GetFileName(filePath).Length <= 30)
             .ToArray();


            foreach (string excelFilePath in excelFilePaths)
            {
                Application excel = new Application();
                Workbook workbook = excel.Workbooks.Add();
                Worksheet worksheet = workbook.Sheets[1]; //storytimeline
                Worksheet worksheet2 = workbook.Sheets[1]; //title_color

                Console.WriteLine(excelFilePath);
                // asset íŒŒì¼ ê²½ë¡œ
                //string assetFilePath = "C:\\Users\\SESI\\Downloads\\homework\\source\\Bundle\\Resources\\Story\\Data\\04\\1001\\storytimeline_041001001.asset";
                
                string[] path = excelFilePath.Split('\\'); // íŒŒì¼ ê²½ë¡œë¥¼ êµ¬ë¶„ 
                string[] fileName = path[12].Split('.'); // íŒŒì¼ ë„¤ì„ì—ì„œ í™•ì¥ìë¥¼ ëºŒ
                                                         // í…ìŠ¤íŠ¸ íŒŒì¼ ê²½ë¡œ
                                                         // string textFilePath = Path.ChangeExtension(assetFilePath, ".txt");
                                                         // asset íŒŒì¼ ë‚´ìš©ì„ í…ìŠ¤íŠ¸ íŒŒì¼ë¡œ ì €ì¥
                                                         //File.WriteAllText(textFilePath, File.ReadAllText(assetFilePath));

                Directory.CreateDirectory(path[0] + "\\" + path[1] + "\\" + path[2] + "\\" + path[3] + "\\" +
  path[4] + "\\" + path[5]); //í´ë” ìƒì„±

                string[] lines = File.ReadAllLines(excelFilePath); //ë¼ì¸ìœ¼ë¡œ í…ìŠ¤íŠ¸ì˜ ê¸€ë“¤ì„ ì‹¹ ì½ì–´ ì˜¨ê±°


                // ì¶”ì¶œí•  ë³€ìˆ˜
                string variable_Text = " Text: \""; //storytimeline ì‹œíŠ¸ì— text ì¹¸ì— ë„£ëŠ”ë‹¤.
                string variable_Name = "  Name:"; // storytimeline ì‹œíŠ¸ì— name ì¹¸ì— ë„£ëŠ”ë‹¤.   
                string variable_Choice = "    NextBlock:"; // storytimeline ì‹œíŠ¸ì— Choicelist ì¼ ê²½ìš° nameì— ì„ íƒì§€ë¼ëŠ” ê¸€ì„ ë„£ê³  textì— ìœ ë‹ˆì½”ë“œë¥¼ ë„£ëŠ”ë‹¤.
                string variable_Title = "Title: \""; //title_color ì‹œíŠ¸ì—ì„œ text ì¹¸ì— ë„£ëŠ”ë‹¤.
                string NextBlock = "  NextBlock:";
                string DifferenceType = "  DifferenceType:";
                string DifferenceType2 = "    DifferenceType:";
                string DifferenceType3 = "  - Text: \""; //ì´ˆì´ìŠ¤ í•­ëª© ì¤‘ì— í…ìŠ¤íŠ¸ë¥¼ ì´ìš©í•œ ì¡°ê±´            //  DifferenceType: 1
                string Reload = "---";
                string Row1Array = null;
                string Row2Array = null;
                //DifferenceFlag: 2 ë‘˜ì˜ ì˜µì…˜ì„ ê°€ì§€ê³  ìˆëŠ” ì˜¤ë¸Œì íŠ¸ëŠ”   NextBlock:3 -> ChoiceList[] 1.NextBlock:4 2.NextBlock:4 
                //ë‹¨ ì£¼ì¸ ì˜¤ë¸Œì íŠ¸ë§Œ í•´ë‹¹ë¨

                worksheet.Name = fileName[0];

                // íŒŒì¼ ë„¤ì„ì—ì„œ í™•ì¥ìë¥¼ ëº€ ë³€ìˆ˜ë¥¼ ì‹œíŠ¸ ì´ë¦„ìœ¼ë¡œ ì§€ì •
                worksheet = (Excel.Worksheet)workbook.Worksheets.get_Item(1);

                worksheet.Cells[1, 1] = "path";
                worksheet.Cells[1, 2] = "filename";
                worksheet.Cells[1, 3] = "name";
                worksheet.Cells[1, 4] = "name_kr";
                worksheet.Cells[1, 5] = "text";
                worksheet.Cells[1, 6] = "text_kr";
                worksheet2 = (Excel.Worksheet)workbook.Worksheets.Add(Type.Missing, worksheet, Type.Missing, Type.Missing);
                /// ì‹œíŠ¸2ì— ë‚´ìš© ì§‘ì–´ë„£ê¸°
                if (workbook.Worksheets.Count >= 2)
                {

                    worksheet2.Name = "title_color";

                    worksheet2.Cells[1, 1] = "path";
                    worksheet2.Cells[1, 2] = "filename";
                    worksheet2.Cells[1, 3] = "text";
                    worksheet2.Cells[1, 4] = "text_kr";
                }
                else
                {
                    Console.WriteLine("í•´ë‹¹ ì›Œí¬ë¶ì— ë‘ ë²ˆì§¸ ì›Œí¬ì‹œíŠ¸ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                }

                int row = 2;
                int count = 0;

                foreach (string line in lines)
                {
                    if (line.Contains(NextBlock)) //nextblock ì—ì„œ ë½‘ì•„ë‚¸ ì •ìˆ˜ë¡œ ë¬¸ì¥ì •ë ¬
                    {
                        count++;

                    }
                }
                int[] nextBlocks = new int[count];
                string[] values3_Name = new string[count];
                string[] values3_Text = new string[count];

                bool ChoiceOne = false;
                bool Gates = false;
                bool sibaljum = false;
                bool sibaljum_Row = false;
                bool sibaljum2 = false;
                bool sibaljum3_1 = false;
                bool sibaljum3_2 = false;
                bool One_sibaljum = false;
                string[] values2_Name = null;
                string[] values2_Text = null;

                int Stepup = 0;
                int CountRow = 0;
                int different = 0;
                int variableblock = 0;
                int ChoiceNumber = 0;
                int row1 = 0; int row2 = 0;
                for (int i = 2; i <= count; i++) //ië¥¼ ì´ìš©í•´ì„œ ìˆœì„œëŒ€ë¡œ ì¶œë ¥í•˜ê²Œ ë§Œë“ ë‹¤.
                {
                    values2_Name = null;
                    values2_Text = null;

                    foreach (string line in lines)  // nextBlock: i ë¥¼ ì°¾ëŠ”ë‹¤.
                    {
                        if (line.Contains(variable_Name)) // Check if the line contains "Name: "
                        {

                            string[] values = line.Split(':');
                            values[1] = null;
                            values = line.Split(':');
                            //Name:
                            if (values[1] == " ") //"Name:" ì´ë€ ë³€ìˆ˜ëŠ” ìˆëŠ”ë° ê°’ì´ ì—†ì„ ê²½ìš° 
                            {
                                // values2_Name = line.Split(':');
                                string decoded = System.Text.RegularExpressions.Regex.Unescape(values[1]); //ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ë¥¼ ë””ì½”ë”©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                                values2_Name = decoded.Split('\"');
                                //RowMinus1 =true;
                            }
                            if (!string.IsNullOrEmpty(values[1]))
                            {

                                string decoded = System.Text.RegularExpressions.Regex.Unescape(values[1]); //ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ë¥¼ ë””ì½”ë”©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                                values2_Name = decoded.Split('\"');
                                //worksheet.Cells[row, 3] = values2_Name[1].Trim();
                                //RowMinus2 = true;
                            }

                        }
                        else if (line.Contains(variable_Choice)) //choice ìª½ì¸ë° Nameì„ ì¶œë ¥í•´ì•¼ í•˜ëŠ” ê²½ìš° variable_Choice = "    NextBlock:"
                        {
                            string[] values = line.Split(':');
                            if (int.Parse(values[1]) == variableblock + 1)
                            {
                                sibaljum = true; //ì´ê±¸ ì¶œë ¥ì„ ì œí•œí•˜ëŠ” ìš©ë„ë¡œ ì”€
                                One_sibaljum = true;//ì´ê±¸ ì¶œë ¥ì„ ì œí•œí•˜ëŠ” ìš©ë„ë¡œ ì”€ ë¬´ì¡°ê±´ ì²˜ìŒë§Œ +1ì„ í•˜ë„ë¡ í•¨
                                                    //Console.WriteLine(variableblock);
                                sibaljum_Row = true;

                            }


                            //worksheet.Cells[row, 3] = "ì„ íƒì§€"; //ChoiceListë¥¼ Name ìª½ì— "ì„ íƒì§€"ë¡œ ì €ì¥
                            if (int.Parse(values[1]) == i)
                            {
                                ChoiceOne = true;
                            }

                        }
                        if (line.Contains(variable_Text)) // Check if the line contains "Text: "
                        {

                            string[] values = line.Split(':');
                            string japaneseString = values[1].Trim(); // Remove leading/trailing space
                            string decoded = System.Text.RegularExpressions.Regex.Unescape(japaneseString); //ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ë¥¼ ë””ì½”ë”©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                            values2_Text = decoded.Split('\"');


                            //path[6~11] 
                            worksheet.Cells[row, 1] = path[6].Trim() + "\\" + path[7].Trim() + "\\" + path[8].Trim() + "\\" + path[9].Trim() + "\\" +
                                path[10].Trim() + "\\" + path[11].Trim(); //Path ì¶œë ¥

                            //path[12] 
                            worksheet.Cells[row, 2] = fileName[0].Trim(); //Filename ì¶œë ¥


                            Gates = true;
                        }
                        if (line.Contains(DifferenceType))
                        {
                            string[] values = line.Split(':');
                            if (int.Parse(values[1]) == 1) //DifferenceTypeì´ 1ì´ë¼ë©´ ë³€ìˆ˜ 1 ì •ì˜   DifferenceType:
                            {
                                different = 1;
                            }
                            else // DifferenceTypeì´ 1ì´ ì•„ë‹ˆë¼ë©´ ê±°ë¶€
                            {
                                different = 0;
                            }
                        }
                        if (line.Contains(DifferenceType2)) //ê±°ë¦„ë§2 "    DifferenceType:";
                        {
                            string[] values = line.Split(':');

                            different = 0;

                        }
                        if (line.Contains(DifferenceType3)) // ì´ˆì´ìŠ¤ í•­ëª© ì¤‘ì— í…ìŠ¤íŠ¸ë¥¼ ì´ìš©í•œ ì¡°ê±´ "  - Text: \""
                        {
                            ChoiceNumber++;
                        }
                        if (line.Contains(NextBlock))//NextBlock: "  NextBlock:"  
                        { //NextBlockì„ ìˆ«ììˆœìœ¼ë¡œ ì°¨ë¡€ëŒ€ë¡œ ê²€ì‚¬í•˜ì—¬ ì—‘ì…€ì— ì €ì¥

                            string[] values = line.Split(':');
                            if (Stepup - 1 == int.Parse(values[1]))
                            {
                                CountRow = 8;
                            }
                            if (Gates == true) //Text ë³€ìˆ˜ì—ì„œ ë¬¸ì¥ì„ ê°€ì ¸ì™”ì„ ë•Œ
                            {
                                if (different == 1) // ìœ ì¼í•œ ë¬¸ì œ ì—¬ê¸°ì„œ differentëŠ” ì²˜ìŒì—ë§Œ ì‘ìš©í•˜ê³  í›„ì— ì´ˆì´ìŠ¤ì— ê´€í•œ ì¡°ê±´ì„ ë¶€ì •í•œë‹¤.
                                {
                                    if (sibaljum == true) //ì—¬ê¸°ì„œ ë‚˜ì˜¨ ì •ìˆ˜ë“¤ì€ ì²« ë²ˆì§¸ë¡œ ë‚˜ì˜¨ ê²ƒì„ +1ì„ ì‹œí‚¨ë‹¤. ê·¸ë¦¬ê³  
                                    {
                                        //ì•„ë§ˆ ì—¬ê¸°ì„œ i++ì„ ì‹œí‚¤ë©´ ë ë“¯?
                                        if (One_sibaljum == true) //ì²« ë²ˆì§¸ë§Œ ì ìš©
                                        {
                                            i++;
                                            sibaljum2 = true;
                                        }
                                        ChoiceOne = true;
                                        One_sibaljum = false;
                                        Console.WriteLine(i); //4, 44 ê°€ ë‚˜ì˜¨ë‹¤.
                                        Console.WriteLine(int.Parse(values[1])); //4, 44ê°€ ë‚˜ì˜¨ë‹¤.
                                        Stepup = int.Parse(values[1]);
                                    }
                                }
                            }
                            if (int.Parse(values[1]) == i)//ië¥¼ ì´ìš©í•´ì„œ ìˆœì„œëŒ€ë¡œ ì¶œë ¥í•˜ê²Œ ë§Œë“ ë‹¤.
                            {

                                if (Gates == true) //Text ë³€ìˆ˜ì—ì„œ ë¬¸ì¥ì„ ê°€ì ¸ì™”ì„ ë•Œ
                                {
                                    //ì¶œë ¥í–ˆë˜ ë¬¸ì¥ì„ ë¹¼ë‚´ëŠ” ë¬¸ë‹¨.
                                    if (ChoiceOne == true)
                                    {
                                        worksheet.Cells[row, 3] = "ì„ íƒì§€";

                                    }
                                    else
                                    {
                                        if (values2_Name.Length >= 2)
                                        {
                                            variableblock = int.Parse(values[1]);
                                            worksheet.Cells[row, 3] = values2_Name[1];

                                        }
                                        else
                                        {
                                            worksheet.Cells[row, 3] = "";
                                            // ë°°ì—´ì˜ ê¸¸ì´ê°€ ì¶©ë¶„í•˜ì§€ ì•Šì€ ê²½ìš° ì˜ˆì™¸ ì²˜ë¦¬
                                        }
                                    }
                                    worksheet.Cells[row, 5] = values2_Text[1];
                                    row++;
                                    Gates = false;
                                }

                            }

                        }
                        if (line.Contains(Reload)) //êµ¬ë¶„ìê°€ ëë‚˜ëŠ” ê³³ì´ë¯€ë¡œ ì´ˆê¸°í™”ë¥¼ í•˜ëŠ” ê³³ì´ë‹¤. "---";
                        {
                            if (sibaljum == true && ChoiceNumber >= 1 && sibaljum2 == true) // iì„ -1í•œë‹¤.
                            {

                                if (ChoiceNumber == 1)
                                {
                                    i--;
                                    Console.WriteLine(i + "R1");
                                    //row -= 1;
                                }
                                if (ChoiceNumber == 2)
                                {
                                    i--;
                                    Console.WriteLine(i + "R2");
                                    //row -= 2;
                                }

                            }
                            if (ChoiceOne == true && ChoiceNumber >= 1 && (CountRow == 8) && sibaljum_Row == true) // Rowë¥¼ ëº€ë‹¤
                            {

                                if (ChoiceNumber == 1)
                                {

                                    sibaljum3_1 = true;
                                    CountRow = 0;
                                    sibaljum_Row = false;
                                    row -= 1;
                                    Row1Array += row + ".";
                                    row1 = row;
                                }
                                if (ChoiceNumber == 2)
                                {

                                    sibaljum3_2 = true;
                                    CountRow = 0;
                                    sibaljum_Row = false;
                                    row -= 2;
                                    Row2Array += row + ".";
                                    row2 = row;
                                }
                            }
                            different = 0; //deferent ì´ˆê¸°í™”

                            variableblock = 0;

                            ChoiceNumber = 0;
                            Stepup = 0;
                            ChoiceOne = false;
                            sibaljum = false;
                            sibaljum2 = false;

                        }

                        /////
                        if (line.Contains(variable_Title)) //Title ì‹œíŠ¸ ê°’ ì €ì¥
                        {
                            if (line.Contains("\""))
                            {
                                string[] values = line.Split(':');

                                string japaneseString = values[1].Trim(); // Remove leading/trailing whitespac
                                string decoded = System.Text.RegularExpressions.Regex.Unescape(japaneseString);
                                values2_Text = decoded.Split('\"');
                                worksheet2.Cells[2, 3] = values2_Text[1].Trim();
                            }
                            else
                            {
                                string[] values = line.Split(':');
                                string japaneseString = values[1].Trim();
                                worksheet2.Cells[2, 3] = japaneseString.Trim();
                            }


                            //path[6~11] 
                            worksheet2.Cells[2, 1] = path[6].Trim() + "\\" + path[7].Trim() + "\\" + path[8].Trim() + "\\" + path[9].Trim() + "\\" +
                                path[10].Trim() + "\\" + path[11].Trim(); //Path ì¶œë ¥

                            //path[12] 

                            worksheet2.Cells[2, 2] = fileName[0].Trim(); //Filename ì¶œë ¥

                            worksheet2.Cells[2, 5] = "title";
                        }

                    }

                }



                foreach (string line in lines)  // NextBlock: -1ë¥¼ ì°¾ì•„ì„œ ì¶œë ¥.
                {

                    if (line.Contains(variable_Name)) // Check if the line contains "Name: "
                    {
                        string[] values = line.Split(':');
                        //Name:
                        if (values[1] == " ") //"Name:" ì´ë€ ë³€ìˆ˜ëŠ” ìˆëŠ”ë° ê°’ì´ ì—†ì„ ê²½ìš° 
                        {
                            values2_Name[1] = " ";
                        }
                        else
                        {
                            string decoded = System.Text.RegularExpressions.Regex.Unescape(values[1]); //ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ë¥¼ ë””ì½”ë”©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                            values2_Name = decoded.Split('\"');
                        }
                    }
                    if (line.Contains(variable_Text)) // Check if the line contains "Text: "
                    {

                        string[] values = line.Split(':');
                        string japaneseString = values[1].Trim(); // Remove leading/trailing space
                        string decoded = System.Text.RegularExpressions.Regex.Unescape(japaneseString); //ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ë¥¼ ë””ì½”ë”©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                        values2_Text = decoded.Split('\"');

                    }
                    int i = -1;
                    if (line.Contains(NextBlock))//NextBlock: "  NextBlock:"  
                    { //NextBlockì„ ìˆ«ììˆœìœ¼ë¡œ ì°¨ë¡€ëŒ€ë¡œ ê²€ì‚¬í•˜ì—¬ ì—‘ì…€ì— ì €ì¥
                        string[] values = line.Split(':');
                        if (int.Parse(values[1]) == i)
                        {


                            worksheet.Cells[row, 3] = values2_Name[1].Trim();
                            worksheet.Cells[row, 5] = values2_Text[1];


                        }

                    }


                }
                string[] arr = null;
                if (sibaljum3_1 == true)
                {
                     arr = Row1Array.Split('.');
                }
      
                Console.WriteLine(Row1Array);
                string cell;
                if (sibaljum3_1 == true)
                {
                    for (int y = 0; y < arr.Length - 2; y++)
                    {
                        cell = worksheet.Cells[int.Parse(arr[y]), 3].Value;
                        worksheet.Cells[int.Parse(arr[y]), 3].Value = worksheet.Cells[int.Parse(arr[y]) + 1, 3].Value;
                        worksheet.Cells[int.Parse(arr[y]) + 1, 3].Value = cell;

                        cell = worksheet.Cells[int.Parse(arr[y]), 5].Value;
                        worksheet.Cells[int.Parse(arr[y]), 5].Value = worksheet.Cells[int.Parse(arr[y]) + 1, 5].Value;
                        worksheet.Cells[int.Parse(arr[y]) + 1, 5].Value = cell;
                        // sibaljum3_1 = false;
                        Console.WriteLine(arr[y]);

                    }

                }
                string[] arr1 = null;
                if (sibaljum3_2 == true)
                {
                    arr1 = Row2Array.Split('.');
                }
               

                Console.WriteLine(Row2Array);
                if (sibaljum3_2 == true)
                {
                    for (int y = 0; y < arr1.Length - 2; y++)
                    {
                        // Swap values in column 3
                        Console.WriteLine(int.Parse(arr1[y]));
                        cell = worksheet.Cells[int.Parse(arr1[y]), 3].Value;
                        worksheet.Cells[int.Parse(arr1[y]), 3].Value = worksheet.Cells[int.Parse(arr1[y]) + 1, 3].Value;
                        worksheet.Cells[int.Parse(arr1[y]) + 1, 3].Value = cell;
                        cell = worksheet.Cells[int.Parse(arr1[y] + 1), 3].Value;
                        worksheet.Cells[int.Parse(arr1[y]) + 1, 3].Value = worksheet.Cells[int.Parse(arr1[y]) + 2, 3].Value;
                        worksheet.Cells[int.Parse(arr1[y]) + 2, 3].Value = cell;

                        // Swap values in column 5
                        cell = worksheet.Cells[int.Parse(arr1[y]), 5].Value;
                        worksheet.Cells[int.Parse(arr1[y]), 5].Value = worksheet.Cells[int.Parse(arr1[y]) + 1, 5].Value;
                        worksheet.Cells[int.Parse(arr1[y]) + 1, 5].Value = cell;
                        cell = worksheet.Cells[int.Parse(arr1[y] + 1), 5].Value;
                        worksheet.Cells[int.Parse(arr1[y]) + 1, 5].Value = worksheet.Cells[int.Parse(arr1[y]) + 2, 5].Value;
                        worksheet.Cells[int.Parse(arr1[y]) + 2, 5].Value = cell;
                        sibaljum3_1 = false;

                    }

                }
                //ì—‘ì…€ë¥¼ ì €ì¥í•˜ëŠ” ê²½ë¡œ ì„¤ì •
                string savePath = path[0] + "\\" + path[1] + "\\" + path[2] + "\\" + path[3] + "\\" +
                    path[4] + "\\" + path[5] + "\\" + fileName[0];

                workbook.SaveAs(savePath, AccessMode: Excel.XlSaveAsAccessMode.xlExclusive,
    ConflictResolution: Excel.XlSaveConflictResolution.xlLocalSessionChanges);
                workbook.Close();
                excel.Quit();

                //clean up
                ReleaseExcelObject(worksheet);
                ReleaseExcelObject(workbook);
                ReleaseExcelObject(excel);
            }
        }
        private static void ReleaseExcelObject(object obj) // ì—‘ì…€ ì•± ì •ë¦¬
        {
            try
            {
                if (obj != null)
                {
                    Marshal.ReleaseComObject(obj);
                    obj = null;
                }
            }
            catch (Exception ex)
            {
                obj = null;
                throw ex;
            }
            finally
            {
                GC.Collect();
            }
            Console.WriteLine("Excel file created , you can find the file");
        }
    }

}


```


